#!/usr/bin/env cwl-runner

description: >
  The annotation process takes one .sam files and produces an annotated version 
  of the .sam files where each read in each file is given an annotation based on 
  its coordinates. A three base pair overlap with the coordinates of a known genomic
  feature is required for a read to be annotated. In the event that the coordinate
  range of an aligned read overlaps features in multiple databases, the read is
  annotated with each feature type overlapped, but the read is counted toward the
  expression of only the highest priority feature.

  Usage: >
    cwl-runner <this-file-path> --mirna_db <mirna_db> --ucsc_db <ucsc_db> 
    --species_code <species_code> --sam_path <sam_path> --connect_path <conect_path>

requirements:
  - class: DockerRequirement
    dockerPull: quay.io/dmiller15/mir-profiler

class: CommandLineTool

inputs:
  - id: "#mirna_db"
    type: string
    inputBinding:
      prefix: -m

  - id: "#ucsc_db"
    type: string
    inputBinding:
      prefix: -u

  - id: "#species_code"
    type: string
    inputBinding:
      prefix: -o

  - id: "#sam_path"
    type: File
    inputBinding:
      prefix: -s

  - id: "#connect_path"
    type: File
    inputBinding:
      prefix: -x

outputs:
  - id: "#annot_sam"
    type: File
    outputBinding:
      glob: ./*.sam.annot

baseCommand: ["python3", "/home/ubuntu/bin/mirna-profiler/py-tools/mir_sam_annotator.py"]
